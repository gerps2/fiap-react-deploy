# Configura√ß√£o para Coolify
version: "1.0"

# Configura√ß√µes do projeto
project:
  name: "fiap-react-deploy"
  description: "üöÄ Status App FIAP - Painel de Diagn√≥stico do Deploy"
  
# Ambientes
environments:
  production:
    name: "Production"
    domain: "${PROD_DOMAIN}"
    branch: "main"
    dockerfile: "Dockerfile"
    compose_file: "docker-compose.yml"
    build_args:
      - VITE_ENVIRONMENT=production
      - VITE_APP_VERSION=${GITHUB_SHA}
      - VITE_BUILD_TIMESTAMP=${BUILD_TIMESTAMP}
    environment_variables:
      - NODE_ENV=production
      - ENVIRONMENT=production
      - PORT=8080
    secrets:
      - VITE_LOGROCKET_ID
      - VITE_API_URL
    health_check:
      path: "/health"
      port: 8080
      interval: 30
    auto_deploy: true
    
  development:
    name: "Development"
    domain: "${DEV_DOMAIN}"
    branch: "develop"
    dockerfile: "Dockerfile"
    compose_file: "docker-compose.dev.yml"
    build_args:
      - VITE_ENVIRONMENT=dev
      - VITE_APP_VERSION=dev-${GITHUB_SHA}
      - VITE_BUILD_TIMESTAMP=${BUILD_TIMESTAMP}
      - VITE_DEBUG=true
    environment_variables:
      - NODE_ENV=development
      - ENVIRONMENT=dev
      - PORT=8081
      - DEBUG=true
    secrets:
      - VITE_LOGROCKET_ID_DEV
      - VITE_API_URL_DEV
    health_check:
      path: "/health"
      port: 8080
      interval: 15
    auto_deploy: true

# Configura√ß√µes de build
build:
  context: "."
  dockerfile: "Dockerfile"
  
# Configura√ß√µes de rede
network:
  type: "bridge"
  
# Recursos
resources:
  production:
    cpu: "1"
    memory: "512Mi"
    replicas: 2
  development:
    cpu: "0.5"
    memory: "256Mi"
    replicas: 1

# Configura√ß√µes de monitoramento
monitoring:
  enabled: true
  health_checks: true
  logs: true
  metrics: true
